import{z as B}from"./zh-cn-fdcbec76.js";import{_ as H,u as U,j as m,k as j,l as v,r as c,o as f,c as y,i as L,e,w as p,f as g,h as q,x as A,n as h}from"./index-b95edb8d.js";const D={class:"History"},E={class:"History_search"},M={key:0,class:"History_page"},O={__name:"index",setup(P){const a=U(),b=m(),d=m(""),s=m(),t=m({pageNo:1,pageNumber:10,bookname:""});j(()=>{a.dispatch("returnbook",t),k()});const k=async()=>{let n=await v.get("http://localhost/booksy/bookreturntotal.php",{params:{account:a.state.userLocalCache}});b.value=n.data},x=n=>{t.value.pageNumber=n,t.value.bookname=s,a.dispatch("returnbook",t)},w=n=>{t.value.pageNo=n,t.value.bookname=s,a.dispatch("returnbook",t)},C=async(n,l)=>{let i=await v.post("http://localhost/booksy/finduserreturnbookname.php",A.stringify({returnbookname:n,account:a.state.userLocalCache})),u=[];if(d.value=i.data,d.value!=null)for(let r=0;r<i.data.length;r++)u.indexOf(i.data[r].bookreturn_name)===-1&&u.push(i.data[r].bookreturn_name);let o=u.map(r=>({value:r}));l(o)},N=()=>{t.value.bookname=s,d.value==null?b.value=0:b.value=d.value.length,a.dispatch("returnbook",t)},z=()=>{d.value="",s.value="",a.dispatch("returnbook",t),k()};return(n,l)=>{const i=c("el-autocomplete"),u=c("el-button"),o=c("el-table-column"),r=c("el-table"),V=c("el-scrollbar"),I=c("el-pagination"),S=c("el-config-provider");return f(),y("div",D,[L("div",E,[e(i,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=_=>s.value=_),"fetch-suggestions":C,clearable:"",class:"inline-input w-50","trigger-on-focus":!1,placeholder:"请输入书籍名字"},null,8,["modelValue"]),e(u,{onClick:N,disabled:!s.value},{default:p(()=>[h("搜索")]),_:1},8,["disabled"]),e(u,{onClick:z},{default:p(()=>[h("重置")]),_:1})]),e(V,{height:"50vh"},{default:p(()=>[e(r,{data:g(a).state.bookreturnkInfo,border:"",style:{width:"100%"},"row-style":{height:"60px"},"empty-text":"暂无归还记录"},{default:p(()=>[e(o,{prop:"bookreturn_number",label:"账号",width:"140",align:"center"}),e(o,{prop:"bookreturn_type",label:"书籍类型",align:"center",width:"140"}),e(o,{prop:"bookreturn_AuthorName",label:"作者",width:"180",align:"center"}),e(o,{prop:"bookreturn_press",label:"出版社",align:"center",width:"140"}),e(o,{prop:"bookreturn_name",label:"书籍名字",align:"center"}),e(o,{prop:"bookreturn_isbn",width:"140",label:"ISBN",align:"center"}),e(o,{prop:"bookreturn_time",sortable:"",width:"180",label:"还书时间",align:"center"}),e(o,{label:"状态",align:"center",width:"100"},{default:p(()=>[e(u,{type:"success",text:"已归还"},{default:p(()=>[h("已归还")]),_:1})]),_:1})]),_:1},8,["data"])]),_:1}),g(a).state.bookreturnkInfo?(f(),y("div",M,[e(S,{locale:g(B)},{default:p(()=>[e(I,{background:"","current-page":t.value.pageNo,"onUpdate:currentPage":l[1]||(l[1]=_=>t.value.pageNo=_),"page-size":t.value.pageNumber,"onUpdate:pageSize":l[2]||(l[2]=_=>t.value.pageNumber=_),"page-sizes":[10,20],layout:"total, sizes, prev, pager, next, jumper",total:b.value,onSizeChange:x,onCurrentChange:w},null,8,["current-page","page-size","total"])]),_:1},8,["locale"])])):q("",!0)])}}},G=H(O,[["__scopeId","data-v-59cb7a39"]]);export{G as default};
