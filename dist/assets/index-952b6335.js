import{_ as N,a as $,b as M,u as S,j as h,k as A,r as u,o as i,c as k,e as o,w as s,f as g,n as r,t as D,g as w,l as y,E as p,y as x,s as F,v as q,i as f}from"./index-b95edb8d.js";const T=c=>(F("data-v-0bf2afce"),c=c(),q(),c),V={class:"Hot"},z=["src"],H={key:1,style:{color:"#7f7f7f"}},L=T(()=>f("svg",{t:"1695037008994",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"12640",width:"16",height:"16"},[f("path",{d:"M641.1 452.3c-89.5-99.5-89.5-218.8-89.5-387.9C273 173.8 342.7 472.2 332.7 571.6c-69.6-59.6-89.5-198.9-89.5-198.9-79.5 39.8-119.3 139.3-119.3 218.8 4.3 205.3 172.6 369.2 377.9 368 204 4.7 373.2-156.9 377.8-360.8 0.1-2.4 0.1-4.8 0.1-7.2 0-119.4-89.5-179-89.5-338.2-90.9 22.1-153.4 105.5-149.1 199z",fill:"#FF6B6A","p-id":"12641"}),f("path",{d:"M491.8 551.7c129.3 49.7 99.5 189 99.5 228.7 20.7-26 34.3-56.8 39.8-89.5 31.5 23.3 50 60.3 49.7 99.5 0 93.4-75.7 169.1-169.1 169.1s-169-75.7-169-169c9.9-89.6 149.1-159.2 149.1-238.8z",fill:"#FFA9B1","p-id":"12642"})],-1)),R={__name:"index",setup(c){const m=$();M();const e=S();h("1");const _=h({pageNo:"",pageNumber:""});h(!1),A(()=>{e.dispatch("book",_)});const v=l=>{m.push({path:"HotDetail",query:{book_id:e.state.bookInfo[l].book_id}})},B=async l=>{if(e.state.userLocalCache=="")e.state.showlogin=1;else{let n=await y.get("http://localhost/booksy/book_borrow.php",{params:{account:e.state.userLocalCache,bookid:e.state.bookInfo[l].book_id}});n.data=="login"?(p({message:"请先登录",type:"error"}),e.state.showlogin=1):n.data=="yes"?(p({type:"success",message:"借书成功"}),e.dispatch("book",_)):n.data=="max5"?x.error({message:"每个人最多可借5本书,请先归还~",position:"bottom-right"}):n.data==-1&&x.error({message:"图书库存不足",position:"bottom-right"})}},C=l=>{m.push({path:"/index/AddEditBook",query:{book_id:l}})},E=l=>{ElMessageBox.confirm("你确定要删除吗?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{(await y.post("http://localhost/booksy/deletebook.php",qs.stringify({book_id:l}))).data=="yes"?(p({type:"success",message:"删除成功"}),e.dispatch("book",_)):p({type:"error",message:"删除失败"})})};return(l,n)=>{const a=u("el-table-column"),d=u("el-button"),I=u("el-table");return i(),k("div",V,[o(I,{data:g(e).state.bookInfo,border:"",style:{width:"100%"},"row-style":{height:"80px"},"empty-text":"暂无图书"},{default:s(()=>[o(a,{prop:"book_type",label:"书籍类型",width:"140",align:"center"}),o(a,{prop:"book_name",label:"书籍名字",width:"200",align:"center"}),o(a,{prop:"book_AuthorName",label:"作者",align:"center"}),o(a,{prop:"book_press",label:"出版社",align:"center"}),o(a,{label:"图片",width:"160",align:"center"},{default:s(t=>[t.row.book_photo?(i(),k("img",{key:0,src:t.row.book_photo,alt:"",style:{height:"100px"}},null,8,z)):(i(),k("span",H,"暂无图片"))]),_:1}),o(a,{prop:"book_number",width:"60",label:"数量",align:"center"}),o(a,{prop:"book_more",width:"90",label:"借阅人数",align:"center"},{default:s(t=>[L,r(" "+D(t.row.book_more),1)]),_:1}),g(e).state.identity!="用户"&&g(e).state.identity!=""?(i(),w(a,{key:0,label:"操作",align:"center",width:"180"},{default:s(t=>[o(d,{color:"rgb(222, 226, 227)",onClick:b=>C(t.row.book_id)},{default:s(()=>[r(" 编辑 ")]),_:2},1032,["onClick"]),o(d,{color:"rgb(143, 171, 180)",onClick:b=>E(t.row.book_id)},{default:s(()=>[r(" 删除 ")]),_:2},1032,["onClick"])]),_:1})):(i(),w(a,{key:1,label:"操作",align:"center",width:"180"},{default:s(t=>[o(d,{color:"rgb(222, 226, 227)",onClick:b=>v(t.$index)},{default:s(()=>[r(" 详细 ")]),_:2},1032,["onClick"]),o(d,{color:"rgb(143, 171, 180)",onClick:b=>B(t.$index)},{default:s(()=>[r(" 借阅")]),_:2},1032,["onClick"])]),_:1}))]),_:1},8,["data"])])}}},G=N(R,[["__scopeId","data-v-0bf2afce"]]);export{G as default};
